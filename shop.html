<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–∞–≥–∞–∑–∏–Ω</title>
    <link rel="stylesheet" href="css/style.css">
    
    <style>
        .shop-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 90%;
            max-width: 400px;
            margin-bottom: 20px;
        }
        .balance-badge {
            background: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 900;
            color: #FFC107;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            font-size: 1.2rem;
        }

        .section-title {
            width: 90%; max-width: 400px;
            text-align: left;
            margin: 20px 0 10px 0;
            font-weight: bold;
            color: var(--primary);
            font-size: 1.2rem;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ */
        .shop-item {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            transition: transform 0.1s;
        }
        .shop-item:active { transform: scale(0.98); }

        .item-icon {
            width: 50px; height: 50px;
            border-radius: 10px;
            object-fit: contain;
            background: #f5f5f5;
            padding: 5px;
            margin-right: 15px;
        }

        .item-details { flex-grow: 1; }
        .item-name { font-weight: bold; color: var(--text); display: block; }
        .item-desc { font-size: 0.8rem; color: #888; }

        .btn-price {
            border: none;
            padding: 10px 15px;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            min-width: 80px;
            text-align: center;
        }

        /* –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏ */
        .btn-price.buy { background: var(--success); color: white; }
        .btn-price.locked { background: #e0e0e0; color: #999; cursor: not-allowed; }
        .btn-price.equipped { background: var(--primary); color: white; cursor: default; }
        .btn-price.owned { background: var(--accent); color: white; }

        /* –ü—Ä–µ–≤—å—é —Ç–µ–º—ã (–∫—Ä—É–∂–æ—á–µ–∫ —Ü–≤–µ—Ç–∞) */
        .color-preview {
            width: 50px; height: 50px; border-radius: 50%;
            border: 2px solid #ddd;
        }
    </style>
    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>

    <div class="top-bar">
        <a href="index.html" class="btn-back">‚Üê</a>
        <div class="game-info">–ú–∞–≥–∞–∑–∏–Ω</div>
    </div>

    <div class="screen" style="justify-content: flex-start; padding-top: 80px; overflow-y: auto;">
        
        <!-- –ë–∞–ª–∞–Ω—Å -->
        <div class="shop-header">
            <div style="font-weight:bold; color:#777;">–¢–≤–æ–π —Å—á–µ—Ç:</div>
            <div class="balance-badge"><span id="user-coins">0</span> üí∞</div>
        </div>

        <!-- –†–∞–∑–¥–µ–ª: –¢–µ–º—ã -->
        <div class="section-title">üé® –¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</div>
        <div class="shop-grid" id="themes-list">
            <!-- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JS -->
        </div>

        <!-- –†–∞–∑–¥–µ–ª: –°–∫–∏–Ω—ã –†–æ–±–æ—Ç–∞ -->
        <div class="section-title">ü§ñ –°–∫–∏–Ω—ã –¥–ª—è –†–æ–±–æ—Ç–∞</div>
        <div class="shop-grid" id="skins-list">
            <!-- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JS -->
        </div>

        <div style="height: 50px;"></div>
    </div>

    <script>
        // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• –¢–û–í–ê–†–û–í ---
        const THEMES = [
            { id: 'theme-default', name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç', price: 0, color: '#2196F3' },
            { id: 'theme-hacker', name: '–•–∞–∫–µ—Ä', price: 100, color: '#000000' },
            { id: 'theme-unicorn', name: '–ï–¥–∏–Ω–æ—Ä–æ–≥', price: 150, color: '#F3E5F5' },
            { id: 'theme-space', name: '–ö–æ—Å–º–æ—Å', price: 200, color: '#0D1b2a' }
        ];

const SKINS = [
    { id: 'skin-bot', name: '–ù–∞—à –†–æ–±–æ—Ç', price: 0, img: 'mascot.png' },
            { id: 'skin-bot', name: '–û–±—ã—á–Ω—ã–π', price: 0, img: 'https://img.icons8.com/color/480/bot.png' },
            { id: 'skin-transformer', name: '–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä', price: 100, img: 'https://img.icons8.com/color/480/transformer.png' },
            { id: 'skin-android', name: '–ö–∏–±–µ—Ä-–ü–∞–Ω–∫', price: 250, img: 'https://img.icons8.com/color/480/android.png' },
            { id: 'skin-retro', name: '–†–µ—Ç—Ä–æ-–ë–æ—Ç', price: 500, img: 'https://img.icons8.com/color/480/retro-robot.png' }
        ];

        // --- –õ–û–ì–ò–ö–ê ---
        let coins = parseInt(localStorage.getItem('neuroCoins')) || 0;
        let ownedItems = JSON.parse(localStorage.getItem('neuroOwned')) || ['theme-default', 'skin-bot'];
        
        let currentTheme = localStorage.getItem('neuroTheme') || '';
        let currentSkin = localStorage.getItem('neuroSkin') || SKINS[0].img;

        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É —Å—Ä–∞–∑—É
        if(currentTheme) document.body.className = currentTheme;

        function renderShop() {
            document.getElementById('user-coins').innerText = coins;

            // 1. –†–µ–Ω–¥–µ—Ä –¢–ï–ú
            const themesContainer = document.getElementById('themes-list');
            themesContainer.innerHTML = '';
            THEMES.forEach(item => {
                let status = getItemStatus(item.id, item.price, currentTheme === item.id || (item.id === 'theme-default' && !currentTheme));
                
                themesContainer.innerHTML += `
                    <div class="shop-item">
                        <div class="color-preview" style="background:${item.color}"></div>
                        <div class="item-details" style="margin-left:15px;">
                            <span class="item-name">${item.name}</span>
                            <span class="item-desc">${item.price > 0 ? item.price + ' –º–æ–Ω–µ—Ç' : '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ'}</span>
                        </div>
                        <button class="btn-price ${status.class}" onclick="handleItemClick('${item.id}', 'theme', ${item.price}, '${item.color}')">
                            ${status.text}
                        </button>
                    </div>
                `;
            });

            // 2. –†–µ–Ω–¥–µ—Ä –°–ö–ò–ù–û–í
            const skinsContainer = document.getElementById('skins-list');
            skinsContainer.innerHTML = '';
            SKINS.forEach(item => {
                let isEquipped = currentSkin === item.img;
                let status = getItemStatus(item.id, item.price, isEquipped);

                skinsContainer.innerHTML += `
                    <div class="shop-item">
                        <img src="${item.img}" class="item-icon">
                        <div class="item-details">
                            <span class="item-name">${item.name}</span>
                            <span class="item-desc">${item.price > 0 ? item.price + ' –º–æ–Ω–µ—Ç' : '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ'}</span>
                        </div>
                        <button class="btn-price ${status.class}" onclick="handleItemClick('${item.id}', 'skin', ${item.price}, '${item.img}')">
                            ${status.text}
                        </button>
                    </div>
                `;
            });
        }

        function getItemStatus(id, price, isEquipped) {
            if (isEquipped) return { class: 'equipped', text: '–í—ã–±—Ä–∞–Ω–æ' };
            if (ownedItems.includes(id)) return { class: 'owned', text: '–í—ã–±—Ä–∞—Ç—å' };
            if (coins >= price) return { class: 'buy', text: '–ö—É–ø–∏—Ç—å' };
            return { class: 'locked', text: price + ' üí∞' };
        }

        function handleItemClick(id, type, price, value) {
            // –ï—Å–ª–∏ —É–∂–µ –≤—ã–±—Ä–∞–Ω–æ - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
            if ((type === 'theme' && currentTheme === id) || (type === 'skin' && currentSkin === value)) return;

            // –ï—Å–ª–∏ —É–∂–µ –∫—É–ø–ª–µ–Ω–æ - –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–µ–≤–∞–µ–º
            if (ownedItems.includes(id)) {
                equipItem(id, type, value);
                return;
            }

            // –ü–æ–∫—É–ø–∫–∞
            if (coins >= price) {
                if(confirm(`–ö—É–ø–∏—Ç—å "${id}" –∑–∞ ${price} –º–æ–Ω–µ—Ç?`)) {
                    coins -= price;
                    ownedItems.push(id);
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º
                    localStorage.setItem('neuroCoins', coins);
                    localStorage.setItem('neuroOwned', JSON.stringify(ownedItems));
                    
                    confetti();
                    equipItem(id, type, value);
                }
            } else {
                alert("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–æ–Ω–µ—Ç! –ü–æ–∏–≥—Ä–∞–π –µ—â–µ.");
            }
        }

        function equipItem(id, type, value) {
            if (type === 'theme') {
                currentTheme = id === 'theme-default' ? '' : id;
                document.body.className = currentTheme;
                localStorage.setItem('neuroTheme', currentTheme);
            } else {
                currentSkin = value;
                localStorage.setItem('neuroSkin', currentSkin);
            }
            renderShop();
        }

        // –ó–∞–ø—É—Å–∫
        renderShop();
    </script>
</body>
</html>
