<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>–ö–æ–º–Ω–∞—Ç–∞ –ù–µ–π—Ä–æ–Ω–∞</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/robot-animations.css" />
  <link rel="stylesheet" href="css/mobile.css?v=6" />
  
<!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã -->
<script src="/neuro-trainer/js/theme-loader.js?v=2"></script>
  
  <!-- model-viewer -->
  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>

  <style>
    body { 
      overflow: hidden !important;
      margin: 0;
      padding: 0;
    }
    
    .btn-back {
      font-size: 1.5rem;
      text-decoration: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      transition: all 0.2s;
      z-index: 100;
    }
    
    .btn-back:active {
      transform: scale(0.9);
      background: rgba(255,255,255,0.2);
    }

    .room-screen {
      position: fixed;
      top: 60px;
      left: 0;
      right: 0;
      bottom: 80px;
      overflow: hidden;
    }

    .room-view {
      width: 100%;
      height: 100%;
      position: relative;
      background: linear-gradient(180deg, 
        #e8eef5 0%, 
        #f0f4f8 40%, 
        #f5f7fa 40%, 
        #fafbfc 100%);
      overflow: hidden;
      transform-style: preserve-3d;
    }

    /* –ì–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ø–∞–Ω–µ–ª–∏ –Ω–∞ —Å—Ç–µ–Ω–∞—Ö */
    .room-view::before {
      content: '';
      position: absolute;
      top: 0;
      left: 10%;
      right: 10%;
      height: 40%;
      background: 
        linear-gradient(90deg, transparent 0%, rgba(0,229,255,0.05) 20%, transparent 40%),
        linear-gradient(90deg, transparent 60%, rgba(124,77,255,0.05) 80%, transparent 100%);
      pointer-events: none;
      z-index: 1;
    }

    /* –°—Ç–µ–∫–ª—è–Ω–Ω—ã–π –ø–æ–ª —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π */
    .room-view::after {
      content: '';
      position: absolute;
      bottom: -10%;
      left: 50%;
      transform: translateX(-50%) rotateX(60deg);
      width: 140%;
      height: 60%;
      background:
        linear-gradient(90deg, 
          transparent 0%, 
          rgba(0,229,255,0.1) 1px, 
          transparent 2px,
          transparent calc(100% - 2px),
          rgba(124,77,255,0.1) calc(100% - 1px),
          transparent 100%
        ),
        linear-gradient(0deg, 
          transparent 0%, 
          rgba(0,229,255,0.08) 1px, 
          transparent 2px
        );
      background-size: 80px 80px;
      background-color: rgba(240,245,250,0.9);
      box-shadow: 
        inset 0 0 50px rgba(0,229,255,0.1),
        0 -5px 30px rgba(124,77,255,0.05);
      opacity: 0.95;
      z-index: 1;
      animation: floorGlow 4s ease-in-out infinite;
    }

    @keyframes floorGlow {
      0%, 100% { 
        box-shadow: inset 0 0 50px rgba(0,229,255,0.1), 0 -5px 30px rgba(124,77,255,0.05);
      }
      50% { 
        box-shadow: inset 0 0 60px rgba(0,229,255,0.15), 0 -5px 40px rgba(124,77,255,0.1);
      }
    }

    /* –°–≤–µ—Ç—è—â–∏–µ—Å—è –ª–∏–Ω–∏–∏ –Ω–∞ —Å—Ç–µ–Ω–∞—Ö */
    .wall-lines {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 40%;
      pointer-events: none;
      z-index: 2;
    }

    .wall-line {
      position: absolute;
      height: 2px;
      background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(0,229,255,0.4) 50%, 
        transparent 100%);
      animation: linePulse 3s ease-in-out infinite;
    }

    .wall-line:nth-child(1) {
      top: 15%;
      left: 5%;
      width: 30%;
      animation-delay: 0s;
    }

    .wall-line:nth-child(2) {
      top: 25%;
      right: 10%;
      width: 25%;
      animation-delay: 1s;
    }

    .wall-line:nth-child(3) {
      top: 35%;
      left: 15%;
      width: 20%;
      animation-delay: 2s;
    }

    @keyframes linePulse {
      0%, 100% { opacity: 0.3; transform: scaleX(1); }
      50% { opacity: 0.8; transform: scaleX(1.1); }
    }

    .robot-status {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      padding: 15px;
      border-radius: 16px;
      box-shadow: 
        0 6px 20px rgba(0,0,0,0.1),
        0 0 0 1px rgba(0,229,255,0.1);
      min-width: 200px;
      z-index: 20;
    }

    .status-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
      padding-bottom: 10px;
      border-bottom: 2px solid rgba(0,229,255,0.1);
    }

    .robot-avatar {
      font-size: 2rem;
    }

    .robot-name {
      flex: 1;
    }

    .robot-name-text {
      font-weight: bold;
      font-size: 1.1rem;
      color: #333;
      margin: 0;
    }

    .robot-level {
      font-size: 0.8rem;
      color: #666;
      margin: 2px 0 0 0;
    }

    .status-bars {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-icon {
      font-size: 1.3rem;
      min-width: 24px;
      text-align: center;
    }

    .status-bar-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .status-label {
      font-size: 0.75rem;
      color: #666;
      font-weight: 600;
    }

    .status-bar {
      height: 8px;
      background: rgba(224,224,224,0.5);
      border-radius: 10px;
      overflow: hidden;
      position: relative;
    }

    .status-bar-fill {
      height: 100%;
      border-radius: 10px;
      transition: width 0.5s ease, background 0.3s;
      position: relative;
      overflow: hidden;
    }

    .status-bar-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255,255,255,0.4),
        transparent
      );
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    .status-bar-fill.mood {
      background: linear-gradient(90deg, #4CAF50, #8BC34A);
    }

    .status-bar-fill.energy {
      background: linear-gradient(90deg, #00bcd4, #00E5FF);
    }

    .status-bar-fill.hunger {
      background: linear-gradient(90deg, #FF9800, #FFC107);
    }

    .status-bar-fill.low {
      background: linear-gradient(90deg, #f44336, #FF5722) !important;
    }

    .status-value {
      font-size: 0.7rem;
      color: #999;
      font-weight: bold;
      min-width: 35px;
      text-align: right;
    }

    /* –ë–∏–æ-–∫—É–ø–æ–ª –æ–∫–Ω–æ */
    .window-container {
      position: absolute;
      top: 60px;
      right: 40px;
      width: 180px;
      height: 200px;
      background: linear-gradient(180deg, 
        rgba(135,206,235,0.3) 0%, 
        rgba(144,238,144,0.2) 50%,
        rgba(152,251,152,0.3) 100%);
      border-radius: 16px;
      border: 3px solid rgba(255,255,255,0.8);
      box-shadow: 
        inset 0 0 30px rgba(0,229,255,0.1),
        0 10px 40px rgba(0,0,0,0.1),
        0 0 0 1px rgba(0,229,255,0.2);
      overflow: hidden;
      z-index: 2;
      backdrop-filter: blur(5px);
    }

    .window-frame {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
    }

    .window-cross-vertical {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 3px;
      height: 100%;
      background: rgba(255,255,255,0.6);
      box-shadow: 0 0 10px rgba(0,229,255,0.3);
    }

    .window-cross-horizontal {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 100%;
      height: 3px;
      background: rgba(255,255,255,0.6);
      box-shadow: 0 0 10px rgba(0,229,255,0.3);
    }

    .window-sky {
      width: 100%;
      height: 100%;
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, 
        rgba(135,206,250,0.3) 0%, 
        rgba(152,251,152,0.2) 100%);
    }

    /* –†–∞—Å—Ç–µ–Ω–∏—è –≤ –±–∏–æ-–∫—É–ø–æ–ª–µ */
    .bio-plant {
      position: absolute;
      background: linear-gradient(180deg, 
        transparent 0%, 
        rgba(34,139,34,0.6) 100%);
      border-radius: 50% 50% 0 0;
      animation: plantGrow 4s ease-in-out infinite;
    }

    .bio-plant:nth-child(1) {
      bottom: 0;
      left: 10%;
      width: 15px;
      height: 40px;
      animation-delay: 0s;
    }

    .bio-plant:nth-child(2) {
      bottom: 0;
      left: 30%;
      width: 20px;
      height: 50px;
      animation-delay: 0.5s;
    }

    .bio-plant:nth-child(3) {
      bottom: 0;
      right: 25%;
      width: 18px;
      height: 45px;
      animation-delay: 1s;
    }

    .bio-plant:nth-child(4) {
      bottom: 0;
      right: 10%;
      width: 22px;
      height: 55px;
      animation-delay: 1.5s;
    }

    @keyframes plantGrow {
      0%, 100% { transform: scaleY(1); opacity: 0.6; }
      50% { transform: scaleY(1.1); opacity: 0.8; }
    }

    /* –°–≤–µ—Ç—è—â–µ–µ—Å—è —Å–æ–ª–Ω—Ü–µ */
    .bio-sun {
      position: absolute;
      top: 25px;
      right: 30px;
      width: 30px;
      height: 30px;
      background: radial-gradient(circle, 
        rgba(255,215,0,0.8) 0%, 
        rgba(255,165,0,0.4) 100%);
      border-radius: 50%;
      box-shadow: 0 0 20px rgba(255,215,0,0.5);
      animation: bioSunGlow 3s ease-in-out infinite;
    }

    @keyframes bioSunGlow {
      0%, 100% { 
        box-shadow: 0 0 20px rgba(255,215,0,0.5);
        transform: scale(1);
      }
      50% { 
        box-shadow: 0 0 30px rgba(255,215,0,0.7);
        transform: scale(1.05);
      }
    }

    .wall-decor {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 45%;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 60px 60px 0;
      z-index: 3;
      pointer-events: none;
    }

    .decor-item {
      width: 80px;
      height: 80px;
      filter: drop-shadow(0 5px 15px rgba(0,229,255,0.3));
      animation: float 3s ease-in-out infinite;
      transition: transform 0.3s ease;
      pointer-events: auto;
      cursor: pointer;
    }

    .decor-item img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .decor-item:hover {
      transform: translateY(-8px) scale(1.08);
      filter: drop-shadow(0 8px 20px rgba(0,229,255,0.5));
    }

    .decor-item:nth-child(1) { animation-delay: 0s; }
    .decor-item:nth-child(2) { animation-delay: 0.5s; }
    .decor-item:nth-child(3) { animation-delay: 1s; }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }

    .floor-items {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 30%;
      display: flex;
      justify-content: space-around;
      align-items: flex-end;
      padding: 0 50px 40px;
      z-index: 5;
      pointer-events: none;
    }

    .furniture-item {
      width: 100px;
      height: 100px;
      filter: drop-shadow(0 10px 20px rgba(0,229,255,0.2));
      animation: bounce 2.5s ease-in-out infinite;
      transition: transform 0.3s ease;
      pointer-events: auto;
      cursor: pointer;
    }

    .furniture-item img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .furniture-item:hover {
      transform: translateY(-6px) scale(1.05);
      filter: drop-shadow(0 15px 30px rgba(124,77,255,0.3));
    }

    .furniture-item:nth-child(1) { animation-delay: 0s; }
    .furniture-item:nth-child(2) { animation-delay: 0.4s; }
    .furniture-item:nth-child(3) { animation-delay: 0.8s; }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    .robot-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
      width: 350px;
      height: 400px;
    }

    model-viewer {
      width: 100%;
      height: 100%;
      --poster-color: transparent;
    }

    model-viewer::part(default-progress-bar) {
      background: linear-gradient(90deg, #00E5FF, #7C4DFF);
    }

    .thought-bubble {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%) scale(0);
      background: rgba(255,255,255,0.98);
      backdrop-filter: blur(10px);
      padding: 12px 20px;
      border-radius: 20px;
      box-shadow: 
        0 4px 15px rgba(0,0,0,0.15),
        0 0 0 1px rgba(0,229,255,0.2);
      font-weight: bold;
      color: #444;
      font-size: 1rem;
      white-space: nowrap;
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index: 20;
    }

    .thought-bubble::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-top: 10px solid rgba(255,255,255,0.98);
    }

    .thought-bubble.show {
      opacity: 1;
      transform: translateX(-50%) scale(1);
    }

    .particle {
      position: absolute;
      font-size: 1.5rem;
      pointer-events: none;
      z-index: 20;
      animation: particleFloat 2s ease-out forwards;
    }

    @keyframes particleFloat {
      0% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(-100px) scale(1.5);
      }
    }

    .particle.side {
      animation: particleSide 2s ease-out forwards;
    }

    @keyframes particleSide {
      0% {
        opacity: 1;
        transform: translate(0, 0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(var(--x), -80px) scale(1.2);
      }
    }

    .room-controls {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      padding: 12px;
      background: rgba(255,255,255,0.98);
      backdrop-filter: blur(10px);
      border-top: 2px solid rgba(0,229,255,0.1);
      z-index: 100;
      height: 80px;
      box-sizing: border-box;
    }

    .room-btn {
      background: var(--card-bg);
      border: none;
      padding: 10px 8px;
      border-radius: 16px;
      font-size: 0.85rem;
      font-weight: bold;
      color: var(--text);
      box-shadow: 0 3px 10px rgba(0,229,255,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
      cursor: pointer;
      transition: all 0.15s;
    }
    
    .room-btn:active { 
      transform: scale(0.95);
      box-shadow: 0 2px 5px rgba(0,229,255,0.15);
    }
    
    .btn-icon { font-size: 1.6rem; }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: flex-end;
      z-index: 1000;
      animation: fadeIn 0.3s;
    }

    .modal-overlay.active {
      display: flex;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      background: rgba(255,255,255,0.98);
      backdrop-filter: blur(20px);
      width: 100%;
      max-height: 75vh;
      border-radius: 25px 25px 0 0;
      padding: 20px;
      box-shadow: 
        0 -5px 20px rgba(0,0,0,0.2),
        0 0 0 1px rgba(0,229,255,0.1);
      animation: slideUp 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      overflow-y: auto;
    }

    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 2px solid rgba(0,229,255,0.1);
    }

    .modal-title {
      font-size: 1.4rem;
      font-weight: bold;
      color: #333;
    }

    .modal-close {
      font-size: 1.8rem;
      background: none;
      border: none;
      cursor: pointer;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }

    .modal-close:active {
      background: rgba(0,229,255,0.1);
    }

    .category-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
    }

    .category-tab {
      flex: 1;
      padding: 10px 16px;
      background: rgba(240,240,240,0.8);
      border: none;
      border-radius: 12px;
      font-weight: bold;
      font-size: 0.9rem;
      color: #666;
      cursor: pointer;
      transition: all 0.2s;
    }

    .category-tab.active {
      background: linear-gradient(135deg, #00E5FF, #7C4DFF);
      color: white;
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(0,229,255,0.3);
    }

    .decor-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      padding-bottom: 20px;
    }

    .decor-card {
      background: rgba(248,249,250,0.8);
      backdrop-filter: blur(10px);
      border: 3px solid rgba(224,224,224,0.5);
      border-radius: 16px;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .decor-card:active {
      transform: scale(0.95);
    }

    .decor-card.owned {
      border-color: rgba(0,229,255,0.5);
      background: rgba(227,242,253,0.8);
    }

    .decor-card.equipped {
      border-color: rgba(124,77,255,0.5);
      background: rgba(243,229,255,0.8);
      box-shadow: 0 0 0 3px rgba(124,77,255,0.2);
    }

    .decor-icon {
      width: 60px;
      height: 60px;
      margin: 0 auto 8px;
    }

    .decor-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .decor-name {
      font-weight: bold;
      color: #333;
      font-size: 0.95rem;
      margin-bottom: 4px;
    }

    .decor-status {
      color: #666;
      font-size: 0.8rem;
      margin-top: 4px;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>

<body>
  <div class="top-bar">
    <a href="index.html" class="btn-back">‚Üê</a>
    <div class="game-info">üî¨ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</div>
    <div class="balance-badge">
      <span id="coins">0</span> üí∞
    </div>
  </div>

  <div class="room-screen">
    <div class="room-view">
      <!-- –ì–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –ª–∏–Ω–∏–∏ -->
      <div class="wall-lines">
        <div class="wall-line"></div>
        <div class="wall-line"></div>
        <div class="wall-line"></div>
      </div>

      <div class="robot-status">
        <div class="status-header">
          <div class="robot-avatar">ü§ñ</div>
          <div class="robot-name">
            <p class="robot-name-text">–ù–µ–π—Ä–æ–Ω</p>
            <p class="robot-level">–£—Ä–æ–≤–µ–Ω—å <span id="robot-level">1</span></p>
          </div>
        </div>
        <div class="status-bars">
          <div class="status-item">
            <div class="status-icon" id="mood-icon">üòä</div>
            <div class="status-bar-container">
              <div class="status-label">–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
              <div class="status-bar">
                <div class="status-bar-fill mood" id="mood-bar" style="width: 80%"></div>
              </div>
            </div>
            <div class="status-value" id="mood-value">80%</div>
          </div>
          <div class="status-item">
            <div class="status-icon">üîã</div>
            <div class="status-bar-container">
              <div class="status-label">–≠–Ω–µ—Ä–≥–∏—è</div>
              <div class="status-bar">
                <div class="status-bar-fill energy" id="energy-bar" style="width: 70%"></div>
              </div>
            </div>
            <div class="status-value" id="energy-value">70%</div>
          </div>
          <div class="status-item">
            <div class="status-icon">üçî</div>
            <div class="status-bar-container">
              <div class="status-label">–ì–æ–ª–æ–¥</div>
              <div class="status-bar">
                <div class="status-bar-fill hunger" id="hunger-bar" style="width: 60%"></div>
              </div>
            </div>
            <div class="status-value" id="hunger-value">60%</div>
          </div>
        </div>
      </div>

      <!-- –ë–∏–æ-–∫—É–ø–æ–ª –æ–∫–Ω–æ -->
      <div class="window-container">
        <div class="window-sky">
          <div class="bio-sun"></div>
          <div class="bio-plant"></div>
          <div class="bio-plant"></div>
          <div class="bio-plant"></div>
          <div class="bio-plant"></div>
        </div>
        <div class="window-frame">
          <div class="window-cross-vertical"></div>
          <div class="window-cross-horizontal"></div>
        </div>
      </div>

      <div class="wall-decor" id="wall-decor"></div>

      <div class="robot-container" id="robot-container">
        <div class="thought-bubble" id="bubble">–ü—Ä–∏–≤–µ—Ç! üëã</div>
        <model-viewer
          id="robot-model"
          src="cute robot 3d model.glb"
          alt="–ù–µ–π—Ä–æ–Ω"
          camera-controls
          touch-action="pan-y"
          shadow-intensity="0.4"
          environment-image="neutral"
          exposure="1.1"
          camera-orbit="0deg 85deg 3.5m"
          field-of-view="25deg"
          disable-zoom
          interpolation-decay="120"
        >
        </model-viewer>
      </div>

      <div class="floor-items" id="floor-items"></div>
    </div>
  </div>

  <div class="room-controls">
    <button class="room-btn" onclick="openDecorShop()">
      <span class="btn-icon">üé®</span>
      <span>–î–µ–∫–æ—Ä</span>
    </button>
    <button class="room-btn" onclick="feedRobot()">
      <span class="btn-icon">‚ö°</span>
      <span>–ü–æ–∫–æ—Ä–º–∏—Ç—å</span>
    </button>
  </div>

  <div class="modal-overlay" id="modal" onclick="closeModalOnOverlay(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
      <div class="modal-header">
        <div class="modal-title">üîÆ –ú–∞–≥–∞–∑–∏–Ω –¥–µ–∫–æ—Ä–∞</div>
        <button class="modal-close" onclick="closeDecorShop()">√ó</button>
      </div>
      <div class="category-tabs">
        <button class="category-tab active" onclick="showCategory('wall')">üîÆ –ì–æ–ª–æ–≥—Ä–∞–º–º—ã</button>
        <button class="category-tab" onclick="showCategory('floor')">üî¨ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</button>
      </div>
      <div class="decor-grid" id="decor-grid"></div>
    </div>
  </div>

  <script>
    const decorItems = {
      wall: [
        { id: 'hologram', icon: 'images/decor/hologram.svg', name: '–ì–æ–ª–æ–≥—Ä–∞–º–º–∞', price: 0 },
        { id: 'neural', icon: 'images/decor/neural-network.svg', name: '–ù–µ–π—Ä–æ—Å–µ—Ç—å', price: 100 },
        { id: 'dna', icon: 'images/decor/dna.svg', name: '–î–ù–ö —Å–ø–∏—Ä–∞–ª—å', price: 120 },
        { id: 'atom', icon: 'images/decor/atom.svg', name: '–ê—Ç–æ–º', price: 150 },
        { id: 'formula', icon: 'images/decor/formula.svg', name: '–§–æ—Ä–º—É–ª–∞', price: 80 },
        { id: 'circuit', icon: 'images/decor/circuit.svg', name: '–°—Ö–µ–º–∞', price: 130 },
      ],
      floor: [
        { id: 'levitation', icon: 'images/furniture/levitation.svg', name: '–õ–µ–≤–∏—Ç–∞—Ü–∏—è', price: 0 },
        { id: 'neon-plant', icon: 'images/furniture/neon-plant.svg', name: '–ù–µ–æ–Ω —Ä–∞—Å—Ç–µ–Ω–∏–µ', price: 180 },
        { id: 'holo-desk', icon: 'images/furniture/holo-desk.svg', name: '–ì–æ–ª–æ-—Å—Ç–æ–ª', price: 250 },
        { id: 'cyber-shelf', icon: 'images/furniture/cyber-shelf.svg', name: '–ö–∏–±–µ—Ä-—à–∫–∞—Ñ', price: 220 },
      ]
    };

    let coins = parseInt(localStorage.getItem('neuroCoins')) || 0;
    let ownedDecor = JSON.parse(localStorage.getItem('ownedDecor')) || ['hologram', 'levitation'];
    let equippedDecor = JSON.parse(localStorage.getItem('equippedDecor')) || {
      wall: ['hologram'],
      floor: ['levitation']
    };
    let currentCategory = 'wall';

    let robotStatus = {
      mood: parseInt(localStorage.getItem('robotMood')) || 80,
      energy: parseInt(localStorage.getItem('robotEnergy')) || 70,
      hunger: parseInt(localStorage.getItem('robotHunger')) || 60,
      level: parseInt(localStorage.getItem('robotLevel')) || 1,
      lastVisit: parseInt(localStorage.getItem('robotLastVisit')) || Date.now()
    };

    function updateRobotEmotion() {
      const moodIcon = document.getElementById('mood-icon');
      
      if (robotStatus.energy < 20) {
        moodIcon.textContent = 'üò¥';
      } else if (robotStatus.mood > 80) {
        moodIcon.textContent = 'üòä';
      } else if (robotStatus.mood < 30) {
        moodIcon.textContent = 'üòû';
      } else if (robotStatus.hunger < 25) {
        moodIcon.textContent = 'üòê';
      } else if (robotStatus.energy < 40) {
        moodIcon.textContent = 'üò™';
      } else {
        moodIcon.textContent = 'üôÇ';
      }
    }

    function createParticles(emoji, count = 5) {
      const container = document.getElementById('robot-container');
      const rect = container.getBoundingClientRect();
      
      for (let i = 0; i < count; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle side';
        particle.textContent = emoji;
        particle.style.left = '50%';
        particle.style.top = '50%';
        particle.style.setProperty('--x', (Math.random() - 0.5) * 150 + 'px');
        container.appendChild(particle);
        
        setTimeout(() => particle.remove(), 2000);
      }
    }

    function updateRobotStatus() {
      const now = Date.now();
      const timePassed = (now - robotStatus.lastVisit) / 1000 / 60;
      
      if (timePassed > 5) {
        robotStatus.energy = Math.max(10, robotStatus.energy - Math.floor(timePassed / 5));
        robotStatus.hunger = Math.max(10, robotStatus.hunger - Math.floor(timePassed / 3));
        robotStatus.mood = Math.max(20, robotStatus.mood - Math.floor(timePassed / 10));
      }
      
      robotStatus.lastVisit = now;
      updateStatusBars();
      updateRobotEmotion();
      saveRobotStatus();
    }

    function updateStatusBars() {
      const moodBar = document.getElementById('mood-bar');
      const energyBar = document.getElementById('energy-bar');
      const hungerBar = document.getElementById('hunger-bar');
      
      moodBar.style.width = robotStatus.mood + '%';
      energyBar.style.width = robotStatus.energy + '%';
      hungerBar.style.width = robotStatus.hunger + '%';
      
      document.getElementById('mood-value').textContent = robotStatus.mood + '%';
      document.getElementById('energy-value').textContent = robotStatus.energy + '%';
      document.getElementById('hunger-value').textContent = robotStatus.hunger + '%';
      document.getElementById('robot-level').textContent = robotStatus.level;
      
      moodBar.classList.toggle('low', robotStatus.mood < 30);
      energyBar.classList.toggle('low', robotStatus.energy < 30);
      hungerBar.classList.toggle('low', robotStatus.hunger < 30);
    }

    function saveRobotStatus() {
      localStorage.setItem('robotMood', robotStatus.mood);
      localStorage.setItem('robotEnergy', robotStatus.energy);
      localStorage.setItem('robotHunger', robotStatus.hunger);
      localStorage.setItem('robotLevel', robotStatus.level);
      localStorage.setItem('robotLastVisit', robotStatus.lastVisit);
    }

    function updateUI() {
      document.getElementById('coins').textContent = coins;
      renderRoom();
    }

    function renderRoom() {
      const wallDecor = document.getElementById('wall-decor');
      const floorItems = document.getElementById('floor-items');
      wallDecor.innerHTML = '';
      floorItems.innerHTML = '';

      equippedDecor.wall.forEach(id => {
        const item = [...decorItems.wall, ...decorItems.floor].find(i => i.id === id);
        if (item) {
          const div = document.createElement('div');
          div.className = 'decor-item';
          div.innerHTML = `<img src="${item.icon}" alt="${item.name}">`;
          wallDecor.appendChild(div);
        }
      });

      equippedDecor.floor.forEach(id => {
        const item = [...decorItems.wall, ...decorItems.floor].find(i => i.id === id);
        if (item) {
          const div = document.createElement('div');
          div.className = 'furniture-item';
          div.innerHTML = `<img src="${item.icon}" alt="${item.name}">`;
          floorItems.appendChild(div);
        }
      });
    }

    function openDecorShop() {
      document.getElementById('modal').classList.add('active');
      renderShop();
    }

    function closeDecorShop() {
      document.getElementById('modal').classList.remove('active');
    }

    function closeModalOnOverlay(e) {
      if (e.target.id === 'modal') closeDecorShop();
    }

    function renderShop() {
      const grid = document.getElementById('decor-grid');
      grid.innerHTML = '';

      decorItems[currentCategory].forEach(item => {
        const owned = ownedDecor.includes(item.id);
        const equipped = equippedDecor[currentCategory].includes(item.id);

        const card = document.createElement('div');
        card.className = 'decor-card' + (owned ? ' owned' : '') + (equipped ? ' equipped' : '');
        card.onclick = () => handleDecorClick(item, owned, equipped);

        let status = '';
        if (equipped) status = '‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ';
        else if (owned) status = 'üì¶ –ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
        else status = `${item.price} üí∞`;

        card.innerHTML = `
          <div class="decor-icon"><img src="${item.icon}" alt="${item.name}"></div>
          <div class="decor-name">${item.name}</div>
          <div class="decor-status">${status}</div>
        `;

        grid.appendChild(card);
      });
    }

    function handleDecorClick(item, owned, equipped) {
      if (equipped) {
        equippedDecor[currentCategory] = equippedDecor[currentCategory].filter(id => id !== item.id);
        showBubble('–£–±—Ä–∞–ª!');
      } else if (owned) {
        if (equippedDecor[currentCategory].length >= 3) {
          showBubble('–ú–∞–∫—Å–∏–º—É–º 3!');
          return;
        }
        equippedDecor[currentCategory].push(item.id);
        showBubble('–£—Å—Ç–∞–Ω–æ–≤–∏–ª! üéâ');
        robotStatus.mood = Math.min(100, robotStatus.mood + 5);
        createParticles('‚ú®', 3);
        updateStatusBars();
        updateRobotEmotion();
      } else {
        if (coins < item.price) {
          showBubble('–ù–µ—Ç –º–æ–Ω–µ—Ç! üí∞');
          return;
        }
        coins -= item.price;
        ownedDecor.push(item.id);
        equippedDecor[currentCategory].push(item.id);
        showBubble('–ö—É–ø–ª–µ–Ω–æ! ‚ú®');
        playSound('buy');
        robotStatus.mood = Math.min(100, robotStatus.mood + 10);
        createParticles('üéâ', 5);
        updateStatusBars();
        updateRobotEmotion();
      }

      saveData();
      saveRobotStatus();
      updateUI();
      renderShop();
    }

    function showCategory(category) {
      currentCategory = category;
      document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
      renderShop();
    }

    function feedRobot() {
      if (coins < 10) {
        showBubble('–ù—É–∂–Ω–æ 10 –º–æ–Ω–µ—Ç! üí∞');
        return;
      }
      
      coins -= 10;
      robotStatus.hunger = Math.min(100, robotStatus.hunger + 30);
      robotStatus.energy = Math.min(100, robotStatus.energy + 20);
      robotStatus.mood = Math.min(100, robotStatus.mood + 15);
      
      showBubble('–ù—è–º-–Ω—è–º! üòãüçî');
      createParticles('üçî', 4);
      createParticles('‚ù§Ô∏è', 3);
      
      if (typeof confetti !== 'undefined') {
        confetti({ particleCount: 80, spread: 70, origin: { x: 0.5, y: 0.6 } });
      }
      
      updateStatusBars();
      updateRobotEmotion();
      saveData();
      saveRobotStatus();
      updateUI();
    }

    function showBubble(text) {
      const bubble = document.getElementById('bubble');
      bubble.textContent = text;
      bubble.classList.add('show');
      setTimeout(() => bubble.classList.remove('show'), 2500);
    }

    function playSound(type) {
      const soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
      if (!soundEnabled) return;
      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      if (type === 'buy') {
        oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.1);
      }
      const volume = (parseInt(localStorage.getItem('soundVolume')) || 70) / 100 * 0.3;
      gainNode.gain.setValueAtTime(volume, audioCtx.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
      oscillator.start();
      oscillator.stop(audioCtx.currentTime + 0.2);
    }

    function saveData() {
      localStorage.setItem('neuroCoins', coins);
      localStorage.setItem('ownedDecor', JSON.stringify(ownedDecor));
      localStorage.setItem('equippedDecor', JSON.stringify(equippedDecor));
    }

    document.getElementById('robot-model').addEventListener('click', function() {
      const phrases = [
        '–ü—Ä–∏–≤–µ—Ç! üëã',
        '–Ø —Ç—É—Ç! ü§ñ',
        '–ß—Ç–æ –¥–µ–ª–∞–µ–º? üéÆ',
        '–£–∫—Ä–∞—Å—å –∫–æ–º–Ω–∞—Ç—É! üé®',
        '–°–º–æ—Ç—Ä–∏ –≤ –æ–∫–Ω–æ! üåø',
        '–ü–æ–∫–æ—Ä–º–∏ –º–µ–Ω—è! üçî',
        '–î–∞–≤–∞–π –∏–≥—Ä–∞—Ç—å! üéØ'
      ];
      showBubble(phrases[Math.floor(Math.random() * phrases.length)]);
      robotStatus.mood = Math.min(100, robotStatus.mood + 2);
      createParticles('‚ù§Ô∏è', 3);
      updateStatusBars();
      updateRobotEmotion();
      saveRobotStatus();
    });

    updateUI();
    updateRobotStatus();
    
    setTimeout(() => {
      if (robotStatus.mood < 40) {
        showBubble('–ú–Ω–µ –≥—Ä—É—Å—Ç–Ω–æ... üòû');
      } else if (robotStatus.energy < 30) {
        showBubble('–Ø —É—Å—Ç–∞–ª... üò¥');
        createParticles('üí§', 3);
      } else if (robotStatus.hunger < 30) {
        showBubble('–•–æ—á—É –∫—É—à–∞—Ç—å! üçî');
      } else {
        showBubble('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é! üî¨');
      }
    }, 1000);

    setInterval(() => {
      robotStatus.energy = Math.max(10, robotStatus.energy - 1);
      robotStatus.hunger = Math.max(10, robotStatus.hunger - 1);
      if (robotStatus.energy < 30 || robotStatus.hunger < 30) {
        robotStatus.mood = Math.max(10, robotStatus.mood - 1);
      }
      updateStatusBars();
      updateRobotEmotion();
      saveRobotStatus();
    }, 60000);
  </script>
</body>
</html>